jQuery(document).ready(function(e){function a(a){i.find(".epkb-wizard-status-bar .epkb-wsb-step").removeClass("epkb-wsb-step--completed"),i.find(".epkb-wizard-status-bar .epkb-wsb-step").each(function(){let t=e(this).attr("id");t[t.length-1]<a&&e(this).addClass("epkb-wsb-step--completed")})}function t(){e("html, body").animate({scrollTop:0},0)}function s(a,t){if("show"===a){let a='<div class="epkb-admin-dialog-box-loading"><div class="epkb-admin-dbl__header"><div class="epkb-admin-dbl-icon epkbfa epkbfa-hourglass-half"></div>'+(t?'<div class="epkb-admin-text">'+t+"</div>":"")+'</div></div><div class="epkb-admin-dialog-box-overlay"></div>';e("body").append(a)}else"remove"===a&&(e(".epkb-admin-dialog-box-loading").remove(),e(".epkb-admin-dialog-box-overlay").remove())}function p(e,a,t){return'<div class="eckb-bottom-notice-message"><div class="contents"><span class="'+t+'">'+(e?"<h4>"+e+"</h4>":"")+(a||"")+"</span></div></div>"}let i=e("#epkb-config-wizard-content");i.length<=0||(i.find(".epkb-setup-wizard-button-apply").on("click",function(a){let t=[],i={action:"epkb_apply_setup_wizard_changes",_wpnonce_apply_wizard_changes:e("#_wpnonce_apply_wizard_changes").val(),epkb_wizard_kb_id:e("#epkb_wizard_kb_id").val()},n=e('input[name="epkp-theme"]:checked').val();void 0===n&&(n="standard"),e(".epkb-menu-checkbox input[type=checkbox]:checked").length&&e(".epkb-menu-checkbox input[type=checkbox]:checked").each(function(){t.push(e(this).prop("name").split("epkb_menu_")[1])}),i.theme_name=n,i.kb_name=e(".epkb-wizard-name input").val(),i.kb_slug=e(".epkb-wizard-slug input").val(),i.menu_ids=t,function(a,t,i,n,b=!1){let o,c;t=void 0===t?"epkb_callback_noop":t,e.ajax({type:"POST",dataType:"json",data:a,url:ajaxurl,beforeSend:function(e){b||s("show",n)}}).done(function(e){((c=e||"").error||void 0===c.message)&&(o=c.message?c.message:p("",epkb_vars.reload_try_again,"error"))}).fail(function(e,a,t){o=t?" ["+t+"]":epkb_vars.unknown_error,o=p(epkb_vars.error_occurred+". "+epkb_vars.msg_try_again,o,"error")}).always(function(){b||s("remove",""),o?(e(".eckb-bottom-notice-message").replaceWith(o),e("html, body").animate({scrollTop:0},"slow")):(b||c.error||void 0===c.message||e(".eckb-bottom-notice-message").replaceWith(p("",c.message,"success")),"function"==typeof t?t(c=void 0===c?"":c):i&&location.reload())})}(i,function(a){a.error||void 0===a.message||(e("#epkb-wsb-step-2-panel").removeClass("epkb-wc-step-panel--active"),e("#epkb-wsb-step-3-panel").addClass("epkb-wc-step-panel--active").show(),e("#epkb-wsb-step-2").removeClass("epkb-wsb-step epkb-wsb-step--active").addClass("epkb-wsb-step epkb-wsb-step--completed"),e("#epkb-wsb-step-3").addClass("epkb-wsb-step epkb-wsb-step--completed"),e(".epkb-setup-info-box__link--edit").attr("href",a.kb_main_page_link),e(".epkb-setup-info-box__link--view").attr("href",a.kb_main_page_view_link),e(".epkb-wizard-top-bar").hide(),e(".epkb-wizard-footer").hide()),e(".epkb-wizard-button-container").hide()},!1,epkb_vars.save_config)}),i.find(".epkb-setup-wizard-button-next").on("click",function(s){s.preventDefault();let p=Number(i.find("#epkb-setup-wizard-button-next").val());e(".epkb-wsb-step").removeClass("epkb-wsb-step--active"),e("#epkb-wsb-step-"+p).addClass("epkb-wsb-step--active"),e(".epkb-wc-step-panel").removeClass("epkb-wc-step-panel--active"),e(".epkb-wc-step-panel-button").removeClass("epkb-wc-step-panel-button--active"),e("#epkb-wsb-step-"+p+"-panel").addClass("epkb-wc-step-panel--active"),e(".epkb-wsb-step-"+p+"-panel-button").addClass("epkb-wc-step-panel-button--active"),e(".epkb-wizard-top-bar").show(),a(p),t()}),i.find(".epkb-setup-wizard-button-prev").on("click",function(s){s.preventDefault();let p=Number(i.find("#epkb-setup-wizard-button-prev").val());e(".epkb-wsb-step").removeClass("epkb-wsb-step--active"),e("#epkb-wsb-step-"+p).addClass("epkb-wsb-step--active"),e(".epkb-wc-step-panel").removeClass("epkb-wc-step-panel--active"),e(".epkb-wc-step-panel-button").removeClass("epkb-wc-step-panel-button--active"),e("#epkb-wsb-step-"+p+"-panel").addClass("epkb-wc-step-panel--active"),e(".epkb-wsb-step-"+p+"-panel-button").addClass("epkb-wc-step-panel-button--active"),e(".epkb-wizard-top-bar").hide(),a(p),t()}),i.find(".epkb-setup-option__featured-img-container").on("click",function(a){a.preventDefault(),a.stopPropagation(),i.find(".image_zoom").remove();var t,s=e(this).find("img");t=s.length>1?e(s[0]).is(":visible")?e(s[0]).attr("src"):e(s[1]).is(":visible")?e(s[1]).attr("src"):e(s[2]).attr("src"):e(this).find("img").attr("src"),e(this).after('<div id="epkb_image_zoom" class="image_zoom"><img src="'+t+'" class="image_zoom"><span class="close epkbfa epkbfa-close"></span></div>'),e("html, body").on("click",function(){e("#epkb_image_zoom").remove(),e("html, body").off("click")})}))});